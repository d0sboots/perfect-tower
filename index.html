<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Perfect Tower II Script Editor</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Perfect Tower II Script Editor" />

    <script>worker = new Worker('worker.js')</script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" defer></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js" defer></script>

    <link rel="stylesheet" href="lib/codemirror.css">
    <link rel="stylesheet" href="lib/darcula.css">
    <script src="lib/codemirror.js" defer></script>

    <script src="addon/edit/matchbrackets.js" defer></script>
    <script src="addon/selection/active-line.js" defer></script>
    <script src="scripts/workspaces.js" defer></script>
    <script src="index.js" defer></script>

    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <span id="loadingText" class="infotext">Loading...</span>

    <dialog id="setup">
        <h2 class="settings">Settings</h2>
        <div class="settings-layout">
            <label><input id="autoSpace" type="checkbox" checked onchange="settingsChange()">
                Auto-indent with spaces instead of tabs
            </label>
            <label><input id="fastMacro" type="checkbox" checked onchange="settingsChange()">
                Use faster macro parser
            </label>
            <label><input id="tabWidth" type="number" min=1 style="width: 3em" value=4 onchange="settingsChange()">
                &lt;Tab&gt; width
            </label>
            <fieldset style="display: flex; justify-content: space-between;">
                <legend style="font: revert; margin: revert; padding: revert;">Export format type:</legend>
                <label><input id="v2_format" type="radio" name="exportFormat" checked onchange="settingsChange()">
                    Modern
                </label>
                <label><input id="v1_format" type="radio" name="exportFormat" onchange="settingsChange()">
                    Old
                </label>
                <label><input id="v0_format" type="radio" name="exportFormat" onchange="settingsChange()">
                    Oldest (uncompressed)
                </label>
            </fieldset>
            <div style="display: flex; justify-content: space-between">
                Instructions for importing<br/>code from Kyromyr.github.io
                <button class="basicBtn" style="width: 200px" onclick="settingsClose(); workspaceOtherSite()">Export From Other Site</button>
            </div>
            <button class="basicBtn" onclick="settingsClose()">Close</button>
        </div>
    </dialog>

    <div id="loadingDiv" style="visibility: hidden;">
        <template id="template-nav-item">
            <li class="nav-item"><a class="nav-link" data-toggle="tab" onclick="scriptSelect(this.parentElement)">New Script</a></li>
        </template>

        <div class="top-container">
            <div class="script-buttons">
                <button class="basicBtn" onclick="scriptNew()">New</button>
                <button class="basicBtn basicBtnRed" onclick="scriptDelete()">Delete</button>
                <button class="basicBtn" onclick="scriptImport()">Import</button>
                <button class="basicBtn" onclick="scriptRename()">Rename</button>
            </div>

            <div class="editor-info">
                <div class="editor-info-text">
                    <div>
                      <span class="infotext">Editor: 2.00 ─ Game: v1.0.11</span>
                      <br/>
                      <span id="warning" class="infotext warning">Cannot access Local Storage. Scripts will not save!</span>
                      <a id="compression" class="infotext warning" target="_blank" style="display:none" href="old_browser.html">
                          Browser out of date, can't access CompressionStream API!
                      </a></span>
                    </div>
                    <a href="https://github.com/d0sboots/perfect-tower/blob/main/manual.md" target="_blank">Syntax Manual</a>
                </div>
                <select id="functionList" class="functionList"></select>
            </div>

            <div class="workspaces">
                <div>
                    <button class="basicBtn" onclick="workspaceExportSource()">Export Source</button>
                    <button class="basicBtn" onclick="settingsModal()">Settings ⚙️</button>
                    <div style="flex-grow:1"></div>
                    <div>
                        Workspace:
                        <select id="workspaceList" class="workspaceList" oninput="workspaceListChange(this)"></select>
                    </div>
                </div>
                <div>
                    <button class="basicBtn" onclick="workspaceNew()">New Workspace</button>
                    <button class="basicBtn" onclick="workspaceRename()">Rename Workspace</button>
                    <button class="basicBtn basicBtnRed" onclick="workspaceDelete()">Delete Workspace</button>
                    <button class="basicBtn" onclick="workspaceExport()">Export Workspace</button>
                    <button id="move-script" class="basicBtn" onclick="workspaceMoveScript()">Move Script</button>
                </div>
            </div>
        </div>

        <div class="div-container">
            <div class="div-container-item div-container-border div-container-code">
                <ul id="scripts-tab" class="nav nav-tabs"></ul>
                <textarea id="scripts" placeholder="Scripts go here"></textarea>
            </div>
            <textarea id="output" readonly class="div-container-item textarea div-container-textarea"></textarea>
        </div>
    </div>

</body>
</html>
